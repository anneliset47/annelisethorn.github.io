<!-- File: nn.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="assets/css/styles.css" />
  <link href='https://cdn.jsdelivr.net/npm/boxicons@2.0.5/css/boxicons.min.css' rel='stylesheet'>
  <title>Neural Networks - Annelise Thorn</title>
</head>
<body>
  <!--===== HEADER NAVIGATION =====-->
  <header class="l-header">
    <nav class="nav bd-grid">
      <div><a href="index.html" class="nav__logo">Annelise Thorn</a></div>

      <div class="dropdown">
        <button class="dropbtn">Menu <i class='bx bx-chevron-down'></i></button>
        <div class="dropdown-content">
          <a href="introduction.html">Introduction</a>
          <a href="dataprep_eda.html">Data Prep/EDA</a>
          <a href="clustering.html">Clustering</a>
          <a href="pca.html">PCA</a>
          <a href="naivebayes.html">Naive Bayes</a>
          <a href="dectrees.html">Decision Tree</a>
          <a href="svms.html">SVM</a>
          <a href="nn.html">Neural Net</a>
          <a href="conclusions.html">Conclusion</a>
          <a href="aboutme.html">About Me</a>
          <a href="references.html">References</a>
        </div>
      </div>
    </nav>
  </header>

  <main class="l-main">
    <section class="section" id="nn">
      <h2 class="section-title">Neural Network</h2>

      <!-- (a) Overview -->
      <h3>Overview</h3>
      <p>
        Neural Networks (NNs) are layered function approximators loosely inspired by the brain: an input layer feeds one or more hidden layers, which apply weighted sums and nonlinear activation functions, and an output layer produces predictions. For binary classification, a common setup is ReLU in hidden layers and a Sigmoid at the output to produce a probability in [0,1].
      </p>
      <figure style="display:flex;flex-direction:column;align-items:center;justify-content:center;max-width:400px;margin:2rem auto;text-align:center;">
        <img src="assets/img/nn1.png" alt="Basic Neural Network Diagram" style="height:auto;" />
        <figcaption><strong>Figure 1:</strong> A basic feedforward neural network.</figcaption>
      </figure>

      <!-- (b) Data Preparation -->
      <h3>Data Preparation</h3>
      <p>
        This is a supervised classification task, so labeled data are required. Labels come from ClinVar’s <code>ClinicalSignificance</code> column, simplified into a binary target: any entry containing “pathogenic” is labeled <strong>1 (Pathogenic)</strong>, else <strong>0 (Non-Pathogenic)</strong>. Only records with a valid gene name are used. The feature is the <code>Gene</code> symbol, encoded as an integer (<code>Gene_encoded</code>) for modeling.
      </p>
      <p>
        The dataset is split into <strong>Training</strong> (80%) and <strong>Testing</strong> (20%) sets using <em>stratified</em> sampling to preserve class ratio. These sets are <strong>disjoint</strong> and the split is done <strong>before</strong> model fitting to avoid leakage. Samples of each set are linked and previewed below.
      </p>

      <p>
        Download sample data:
        <a href="assets/data/train_sample.csv" target="_blank">Training sample CSV</a> ·
        <a href="assets/data/test_sample.csv" target="_blank">Test sample CSV</a>
      </p>

      <div style="display:flex;gap:1rem;flex-wrap:wrap;justify-content:center;">
        <figure style="max-width:360px;margin:0;">
          <img src="assets/img/train_sample.png" alt="Training set sample table" style="width:100%;height:auto;">
          <figcaption><strong>Figure 2a:</strong> Training set (sample rows). Disjoint from test set via stratified split.</figcaption>
        </figure>
        <figure style="max-width:360px;margin:0;">
          <img src="assets/img/test_sample.png" alt="Test set sample table" style="width:100%;height:auto;">
          <figcaption><strong>Figure 2b:</strong> Test set (sample rows). Held out for unbiased evaluation.</figcaption>
        </figure>
      </div>

      <!-- (c) Code -->
      <h3>Code</h3>
      <p>
        The model is implemented in Python using TensorFlow/Keras. The network uses ReLU activations in hidden layers and a Sigmoid output for binary classification, trained with Adam (learning rate = <code>0.001</code>) and binary cross-entropy loss for <code>20</code> epochs (batch size <code>16</code>). The repository code reads the data, creates labels, encodes genes, performs the stratified split, trains, and saves the required figures.
      </p>
      <p>
        <a href="https://github.com/anneliset47/annelisethorn.github.io/blob/main/Code/nn.py" target="_blank">View code on GitHub</a>
      </p>

      <!-- (d) Results -->
      <h3>Results</h3>
      <p>
        On the held-out test set, the model achieved an accuracy of <strong>85%</strong> at a 0.5 threshold. It correctly identified all Pathogenic variants in the test set but did not identify the Non-Pathogenic ones. This reflects class imbalance and the simplicity of the single-feature representation.
      </p>

      <div style="display:flex;justify-content:center;gap:2rem;flex-wrap:wrap;align-items:stretch;">
        <figure style="display:flex;flex-direction:column;align-items:center;max-width:800px;margin:0;">
          <img src="assets/img/nn_confusionmatrix.png" alt="Neural Network Confusion Matrix" style="max-width:auto;height:400px;" />
          <figcaption style="font-size:0.95rem;color:#444;text-align:center;margin-top:0.5rem;">
            <strong>Figure 3:</strong> Confusion matrix (threshold 0.5). Overall accuracy: 85%. All 17 Pathogenic predicted correctly; 3 Non-Pathogenic predicted as Pathogenic.
          </figcaption>
        </figure>

        <div style="display:flex;gap:1rem;flex-wrap:wrap;justify-content:center;">
          <figure style="max-width:360px;margin:0;">
            <img src="assets/img/nn_last5_loss.png" alt="Training loss last 5 epochs" style="width:100%;height:auto;">
            <figcaption><strong>Figure 4a:</strong> Training loss (last 5 epochs). Optimizer: Adam (lr=0.001); Loss: Binary Cross-Entropy.</figcaption>
          </figure>
          <figure style="max-width:360px;margin:0;">
            <img src="assets/img/nn_last5_accuracy.png" alt="Training accuracy last 5 epochs" style="width:100%;height:auto;">
            <figcaption><strong>Figure 4b:</strong> Training accuracy (last 5 epochs). Hidden activation: ReLU; Output activation: Sigmoid.</figcaption>
          </figure>
        </div>

        <figure style="display:flex;flex-direction:column;align-items:center;max-width:900px;margin:1rem auto 0;">
          <img src="assets/img/nn_architecture.png" alt="Neural network architecture diagram" style="width:100%;height:auto;">
          <figcaption style="font-size:0.95rem;color:#444;margin-top:0.5rem;">
            <strong>Figure 5:</strong> Architecture used: <em>Input (Gene_encoded)</em> → <em>Dense(64, ReLU)</em> → <em>Dense(32, ReLU)</em> → <em>Dense(1, Sigmoid)</em>.
            Weight matrices \(W^{(1)}, W^{(2)}, W^{(3)}\) and biases \(b^{(1)}, b^{(2)}, b^{(3)}\) connect the layers.
          </figcaption>
        </figure>
      </div>

      <!-- Explicit activation + hyperparameters for reproducibility -->
      <p style="margin-top:1rem;">
        <strong>Activation functions:</strong> Hidden = ReLU; Output = Sigmoid. &nbsp;
        <strong>Optimizer:</strong> Adam (learning rate = 0.001). &nbsp;
        <strong>Loss:</strong> Binary Cross-Entropy. &nbsp;
        <strong>Epochs:</strong> 20. &nbsp;
        <strong>Batch size:</strong> 16.
      </p>

      <!-- (e) Conclusions -->
      <h3>Conclusions</h3>
      <p>
        Using a single categorical feature (<code>Gene_encoded</code>) with a simple NN achieved 85% accuracy on this split, driven by strong performance on the majority (Pathogenic) class. However, the model failed to identify Non-Pathogenic cases at the default threshold, highlighting the effect of class imbalance and limited features. This baseline shows that the network can memorize patterns associated with particular genes, but reliability for minority outcomes is limited without additional signals or design choices.
      </p>

    </section>
  </main>
</body>
</html>
